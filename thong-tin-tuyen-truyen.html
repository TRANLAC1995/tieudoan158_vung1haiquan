<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Thông tin</title>
<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: Arial, sans-serif;
  padding: 20px;
  background: #f0f2f5;
}

header {
  background: rgba(255, 255, 255, .9);
  padding: 15px;
  text-align: center;
  border-radius: 0 0 20px 20px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, .4);
  position: fixed;
  top: 0;
  width: 100%;
  z-index: 1000;
}

header h1 {
  color: #007bff;
  margin-bottom: 10px;
}

header button {
  margin: 3px;
  padding: 8px 12px;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  background: #1e3c72;
  color: #fff;
}

section {
  max-width: 900px;
  margin: 140px auto 40px;
  display: flex;
  flex-direction: column;
  gap: 20px;
}

/* Card đồng đều chiều cao */
.card {
  background: rgba(255, 255, 255, .65);
  padding: 25px;
  border-radius: 20px;
  box-shadow: 0 6px 15px rgba(0, 0, 0, .3);
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  min-height: 250px; /* đặt chiều cao tối thiểu giống nhau */
}

/* Nội dung chỉnh sửa */
.editable[contenteditable="true"] {
  outline: 2px dashed red;
  background: #fff8c6;
}

/* Reset khoảng cách cho danh sách */
.card ul {
  margin: 0;
  padding-left: 20px;
}

.card ul li {
  margin-bottom: 10px;
}

.card ul li:last-child {
  margin-bottom: 0;
}

/* Nút quay lại */
.back-btn {
  text-align: center;
  margin: 30px 0;
}

.back-btn button {
  background: #1e3c72;
  color: #fff;
  border: none;
  padding: 10px 18px;
  border-radius: 12px;
  cursor: pointer;
  font-size: 0.95rem;
}
</style>
</head>
<body>

<header>
  <h1 class="editable" data-key="title-main">Sư đoàn 324, Quân khu 4</h1>
  <button onclick="adminLogin()">🔐 Quản trị</button>
  <button id="editBtn" onclick="toggleEdit()" style="display:none">✏️ Chỉnh sửa</button>
  <button id="saveBtn" onclick="saveContent()" style="display:none">💾 Lưu</button>
  <button id="logoutBtn" onclick="logoutAdmin()" style="display:none">🚪 Thoát</button>
</header>

<section>
  <div class="card">
    <h2 class="editable" data-key="part1-title">I. Lịch sử hình thành và phát triển</h2>
    <p class="editable" data-key="part1-text">Sư đoàn 324, thuộc Quân khu 4, là một trong những đơn vị chủ lực có bề dày lịch sử của Quân đội nhân dân Việt Nam. Được thành lập từ những năm chống Pháp, sư đoàn đã trưởng thành qua nhiều cuộc kháng chiến và trở thành lực lượng mạnh, tinh nhuệ, luôn sẵn sàng nhận nhiệm vụ bảo vệ Tổ quốc.</p>
    <p class="editable" data-key="part1-text2">Trải qua các giai đoạn chiến đấu và xây dựng, Sư đoàn 324 luôn hoàn thành xuất sắc mọi nhiệm vụ, không ngừng nâng cao chất lượng huấn luyện, củng cố tổ chức biên chế, và áp dụng các phương pháp hiện đại để đáp ứng yêu cầu nhiệm vụ trong thời kỳ mới.</p>
  </div>

  <div class="card">
    <h2 class="editable" data-key="part2-title">II. Truyền thống và thành tích nổi bật</h2>
    <ul>
      <li class="editable" data-key="part2-li1">Cán bộ, chiến sĩ Sư đoàn 324 luôn phát huy truyền thống anh hùng, đoàn kết và sáng tạo, vượt qua mọi thử thách để hoàn thành xuất sắc các nhiệm vụ huấn luyện, diễn tập và sẵn sàng chiến đấu.</li>
      <li class="editable" data-key="part2-li2">Sư đoàn nhiều năm liền đạt danh hiệu “Đơn vị Quyết thắng” và được Bộ Quốc phòng, Quân khu 4 khen thưởng vì những thành tích nổi bật trong huấn luyện, xây dựng chính quy và giữ vững kỷ luật.</li>
      <li class="editable" data-key="part2-li3">Tham gia tích cực các hoạt động dân vận, giúp nhân dân khắc phục thiên tai, xây dựng nông thôn mới, góp phần củng cố mối quan hệ quân-dân bền chặt.</li>
      <li class="editable" data-key="part2-li4">Sư đoàn 324 ghi dấu ấn lịch sử qua nhiều chiến công xuất sắc và truyền thống anh hùng trong các cuộc kháng chiến bảo vệ Tổ quốc.</li>
    </ul>
  </div>

  <div class="card">
    <h2 class="editable" data-key="part3-title">III. Nhiệm vụ và chức năng</h2>
    <ul>
      <li class="editable" data-key="part3-li1">Nhiệm vụ chính: Huấn luyện, sẵn sàng chiến đấu; bảo vệ vững chắc địa bàn, mục tiêu quan trọng trong khu vực Quân khu 4.</li>
      <li class="editable" data-key="part3-li2">Phòng chống thiên tai: Tham gia cứu hộ, cứu nạn và hỗ trợ nhân dân khi xảy ra lũ lụt, hạn hán, cháy rừng hoặc các tình huống khẩn cấp khác.</li>
      <li class="editable" data-key="part3-li3">Chức năng: Là lực lượng chủ lực cơ động, sẵn sàng thực hiện nhiệm vụ đột xuất theo lệnh của Bộ Quốc phòng và Quân khu 4.</li>
      <li class="editable" data-key="part3-li4">Lãnh đạo sư đoàn: </li>
    </ul>
  </div>

  <div class="card">
    <h2 class="editable" data-key="part4-title">IV. Hoạt động đơn vị</h2>
    <ul>
      <li class="editable" data-key="part4-text">Thực hiện nghiêm điều lệnh, điều lệ Quân đội Nhân dân Việt Nam; rèn luyện tinh thần chiến sĩ, tính kỷ luật và lòng dũng cảm trong mọi tình huống.</li>
    </ul>
  </div>
</section>

<div class="back-btn">
  <button onclick="window.location.href='hoctap.html'">⬅ Quay lại</button>
</div>

<script>
const ADMIN_PASSWORD = "100"; 
let isAdmin = false;

// URL Apps Script
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyNo4fX5fV5tltpbBVWCOa14X-aW79d9vRM15gkcppFuXDd-phOy7CNaujuJvw30xRCBQ/exec";

const editBtn = document.getElementById("editBtn");
const saveBtn = document.getElementById("saveBtn");
const logoutBtn = document.getElementById("logoutBtn");

// Đăng nhập quản trị
function adminLogin() {
  const pass = prompt("Nhập mật khẩu quản trị:");
  if (pass === ADMIN_PASSWORD) {
    isAdmin = true;
    editBtn.style.display = saveBtn.style.display = logoutBtn.style.display = "inline-block";
    alert("✅ Đã vào chế độ quản trị");
  }
}

// Bật/tắt chế độ chỉnh sửa
function toggleEdit() {
  if (!isAdmin) return;
  document.querySelectorAll(".editable").forEach(el => {
    el.contentEditable = el.contentEditable !== "true";
  });
}

// Lưu nội dung lên Sheet
async function saveContent() {
  if (!isAdmin) return;
  const data = {};
  document.querySelectorAll(".editable").forEach(el => {
    data[el.dataset.key] = el.innerHTML;
  });
  try {
    const res = await fetch(SCRIPT_URL, {
      method: "POST",
      body: JSON.stringify(data)
    });
    const result = await res.json();
    alert("💾 Đã lưu nội dung lên Google Sheet: " + result.status);
  } catch (err) {
    alert("❌ Lỗi lưu: " + err.message);
  }
}

// Tải dữ liệu từ Sheet
async function loadContent() {
  try {
    const res = await fetch(SCRIPT_URL);
    const data = await res.json();
    document.querySelectorAll(".editable").forEach(el => {
      if (data[el.dataset.key]) el.innerHTML = data[el.dataset.key];
    });
  } catch (err) {
    console.error("❌ Lỗi tải dữ liệu:", err);
  }
}

// Đăng xuất quản trị
function logoutAdmin() {
  isAdmin = false;
  document.querySelectorAll(".editable").forEach(el => el.contentEditable = false);
  editBtn.style.display = saveBtn.style.display = logoutBtn.style.display = "none";
}

// Khi mở trang, tải dữ liệu
window.onload = loadContent;
</script>

</body>
</html>
